@if (item) {
  <div class="item-details-panel"
       [ngStyle]="getPanelStyle()"
       (mousemove)="onDrag($event)"
       (mouseup)="onDragEnd()"
       (mouseleave)="onDragEnd()">

    <!-- Header (Decomposed Component) -->
    <app-item-detail-header
      [itemName]="item.definition.name"
      [rarity]="item.definition.rarity"
      [isDragging]="isDragging"
      (close)="onClose()"
      (dragStart)="onDragStart($event)">
    </app-item-detail-header>

    <div class="details-content">
      <!-- Basic Info (Decomposed Component) -->
      <app-item-basic-info
        [icon]="item.definition.icon"
        [itemName]="item.definition.name"
        [description]="item.definition.description"
        [category]="item.definition.category"
        [subcategories]="item.definition.subcategories"
        [rarity]="item.definition.rarity"
        [quantity]="item.quantity"
        [weight]="item.definition.properties.weight"
        [vendorPrice]="item.vendorPrice">
      </app-item-basic-info>

      <!-- Stats Display (Decomposed Component) -->
      <app-item-stats-display
        [category]="item.definition.category"
        [subcategories]="item.definition.subcategories"
        [properties]="item.definition.properties"
        [combatStats]="combatStats"
        [loadingCombatStats]="loadingCombatStats"
        [scaledHealthRestore]="getScaledHealthRestore()"
        [scaledManaRestore]="getScaledManaRestore()"
        [hasPotencyQuality]="hasPotencyQuality()">
      </app-item-stats-display>

      <!-- Modifiers Display (Decomposed Component) -->
      <app-item-modifiers-display
        [qualityDetails]="item.qualityDetails"
        [traitDetails]="item.traitDetails">
      </app-item-modifiers-display>
    </div>

    <!-- Actions (Decomposed Component) -->
    <app-item-actions
      [category]="item.definition.category"
      [quantity]="item.quantity"
      [isEquipped]="!!item.equipped"
      [showActions]="showActions"
      [showDropControls]="showDropControls"
      [isUsingItem]="isUsingItem"
      [dropQuantity]="dropQuantity"
      [maxDropQuantity]="getMaxDropQuantity()"
      (use)="onUse()"
      (equip)="onEquip()"
      (unequip)="onUnequip()"
      (remove)="onRemove()"
      (removeAll)="onRemoveAll()"
      (dropQuantityChange)="updateDropQuantity($event)">
    </app-item-actions>
  </div>
}
